# Ch24 存取控制
存取控制机制的组成
- 定义用户权限, 并将用户权限登记到数据字典中
  - 用户对某一数据对象的操作权力称为权限
- 合法权限检查
  - 用户发出存取数据库操作请求时
  - DBMS查找数据字典, 进行合法权限的检查
- 用户权限定义和合法权限检查机制一起组成了数据库管理系统的存取控制子系统

## 自主存取控制 DAC
- 是C2级
- 用户对不同的数据对象有不同的存取权限
- 不同的用户对同一对象也有不同的权限
- 用户还可以将拥有的权限转授给其他用户

### 自主存取控制方式
![alt text](/assets/ch24image0.png)

定义存取权限称为授权
```SQL
GRANT <权限>[,<权限>]... ON <对象类型> <对象名>[,<对象类型> <对象名>]... TO <用户>[,<用户>]... [WITH GRANT OPTION];
```
将对指定操作对象的指定操作权限授予指定的用户
- 发出GRANT的:
  - 数据库管理员
  - 数据库对象创建者
  - 拥有该权限的用户(转授权限)
- 接受权限的用户
  - 一个或多个具体用户
  - PUBLIC即全体用户
- WITH GRANT OPTION: 若有这个子句表示可以再授予权限, 否则无法转授

```SQL
REVOKE <权限>[,<权限>]... ON <对象类型> <对象名>[,<对象类型> <对象名>]... FROM <用户>[,<用户>]... [CASCADE|RESTRICT];
```
授予的权限可以由数据库管理员或其他授权者收回
- 指定CASCADE会级联回收所有被授予和转授的权限

### 创建数据库模式的权限
数据库管理员创建用户
```SQL
CREATE USER <username> [WITH] [DBA | RESOURCE | CONNECT];
```
- CONNECT: 只能登录数据库, 不能创建用户, 不能创建模式和表
- RESOURCE: 能创建基本表和视图, 但不能创建模式和用户
- DBA: 数据库管理系统的超级用户


数据库角色: 被命名的一组与数据库操作相关的权限
- 角色是权限的集合
- 可以为一组具有相同权限的用户创建一个角色来简化授权的过程

```SQL
CREATE ROLE <角色名>
```
然后就可以像给用户授权那样把角色授予给用户/角色

```SQL
GRANT <角色1>[,<角色2>]... TO <角色或用户>[,<角色或用户>]... [WITH ADMIN OPTION];
```
该语句将角色授予某用户后另一个角色 **记住角色是权限的集合**
- WITH ADMIN OPTION: 可以再转授

角色权限的收回和用户权限的收回类似


**自主存取控制缺点**: 可能存在数据的"无意泄漏"
- 这种机制仅仅通过数据的存取权限来进行安全控制, 而数据本身并无安全性标记

## 强制存取控制 MAC
- B1级, 保证更高程度的安全性
- 每一个数据对象被标以一定的密级
- 每一个用户也被授予某一个级别的许可证
- 对于任意一个对象, 只有具有合法许可证的用户才可以存取
- 用户不能直接感知或进行控制
- 适用于对数据有严格而固定密级分类的部门

在强制存取控制中, 数据库管理系统所管理的全部实体被分为主体和客体两大类
- 主体是系统中的活动实体
  - 数据库管理系统所管理的实际用户
  - 代表用户的各进程
- 客体是系统中的被动实体, 受主体操纵
  - 文件, 基本表, 索引, 视图

### 强制存取控制方法
敏感度标记(Label)
- 对于主体和客体, DBMS为它们每个实例指派一个敏感度标记
- 分成
  - 绝密 TS
  - 机密 S
  - 可信 C
  - 公开 P
- 主体的敏感度标记称为许可证级别
- 客体的敏感度标记称为密级

仅当主体的许可证级别大于等于客体的密级时, 才能读取相应的客体

进当主体的许可证级别小于等于客体的密级时, 才能写相应的客体 **防止高级别的主体把信息写到地级别的客体上造成的泄漏**

## DAC + MAC
实现强制存取控制首先要实现自主存取控制