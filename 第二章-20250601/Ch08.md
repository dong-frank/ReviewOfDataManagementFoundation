# Ch08 关系, 关系模式和关系数据库

## 一些基本概念

### 笛卡尔积

#### 域
域是一组具有相同数据类型的值的集合 *整数域, 实数域, {'男','女'}*

#### 笛卡尔积
给定一组域D1, D2, ..., Dn, 允许其中某些域是相同的
D1, D2, ..., Dn的笛卡尔积就是所有域的所有取值的不重复的一个组合

**通俗理解就是所有可能取值的集合**

笛卡尔积可以表示为一张二维表
表中的每一行对应一个元组, 每一列对应一个域(**因为笛卡尔积是域中所有的可能取值, 这点和关系不同**)

#### 元组
在关系模型中, 关系的每一行称为一个元组

那实际上, 这一行就是笛卡尔积中的一个元素

所以也将笛卡尔积中每一个元素叫作一个元组

#### 分量
在关系模型中, 元组中的一个属性值被称为分量

所以也将一个笛卡尔积元素中的每一个值称为分量

#### 基数
若一个域D为有限集, 元素个数为m, 就称其基数为m

自然笛卡尔积的基数为每个域的基数的乘积

### 关系
关系是反映现实事物的联系, 在现实中不是所有域的取值都可能, 自然关系就是笛卡尔积的子集

$R(D_1, D_2,..., D_n)$

R: 关系名
n: 关系的目或度
元组: 关系中的每个元素, 通常用t表示

关系也是一个二维表

#### 属性
关系中不同列可以对应相同的域(**因为笛卡尔积中是允许有某些域是相同的**), 为了加以区分, 必须对每列起一个名字, 成为属性

n目关系必有n个属性

#### 码
回顾之前的定义, 码是能够区分唯一元组的属性集合

- 候选码(candiate key): 能够区分唯一元组的最小属性集合
  - 最简单情况, 候选码只包含一个属性 *例如身份证号就能唯一区分两个人*
  - 最极端情况, 所有属性组都用上, 才能区分, 那么所有属性组是这个关系模式的候选码, 称为全码
- 主码(primary key): 候选码可以有多个(可能有很多种区分元组的方式), 选定其中一个作为主码
- 主属性: 候选码的属性称为主属性 **注意和主码区别开来, 主码是一个属性集合, 主属性是一个属性**
- 非主属性: 不被任何候选码包含的属性

**记忆tips**: 码是属性的集合, 候选码类比候选人, 可以有很多个候选人, 他们共同竞争成为主码. 候选码中的属性就是主属性

## 关系的类别
我们之前提到, 关系是一张二维表格, 且对关系操作产生的结果也是关系
1. 基本关系: 实际存在的表, 是实际存储数据的逻辑表示
2. 查询表: 由查询操作产生的结果对应的表
3. 试图表: 由基本表或其他试图表导出的表, 是虚表, 不对应实际存储的数据

### 基本关系的性质
1. 列是同质的: 每一列中的分量是同一类型的数据, 来自同一个域 (**因为都是这一列, 也就是这一属性下的**)
2. 不同的列可出自同一个域 (**对应不同的属性, 但是属性取值可能一样**)
3. 列的顺序无所谓
4. 任意两个元组的候选码不能相同: 若相同, 那么就无法区分这两个元组, 那么就和候选码的定义矛盾
5. 行的顺序无所谓
6. 分量必须取原子值: 不能表中嵌套表


## 关系模式
类比数据库中的模式和实例

关系模式是型, 关系是值

关系模式是对关系的描述
- 元组集合的结构
  - 属性构成
  - 属性来自的域
  - 属性与域之间的映像关系
- 完整性约束条件

关系模式表示为$R(U, D, DOM, F)$
- R: 关系名
- U: 组成该关系的属性名集合
- D: U中属性所来自的域的集合
- DOM: 属性向域的映像的集合, 决定哪个属性的取值取自哪个域
- F: 属性间数据的依赖关系的集合

通常可以简记为$R(U)$ 或 $R(A1, A2, ..., An)$

## 关系模式与关系
关系模式
- 对关系的描述
- 静态的, 稳定的

关系
- 关系模式在某一时刻的状态或内容
- 动态的, 随时间不断变化的

关系模式和关系通常都称为关系, 根据上下文区别

## 关系数据库
在一个给定的应用领域中, 所有关系的集合构成一个关系数据库

关系数据库的型: 关系数据库模式, 是对关系数据库的描述

关系数据库的值: 关系模式在某一时刻对应的关系的集合, 通常称为关系数据库